---
import "../styles/global.css";
import ProjectCard from "../components/ProjectCard.astro";
import SkillGrid from "../components/SkillGrid.astro";
import Timeline from "../components/Timeline.astro";
import Contact from "../components/Contact.astro";
import ButtonWrapper from "../components/ButtonWrapper.astro";

import skills from "../data/skills.json";
import experiences from "../data/experiences.json";
import contact from "../data/contact.json";

import { getCollection } from "astro:content";

// Load projects from Markdown collection
const projectsCollection = await getCollection("projects");

// Map each project to props for ProjectCard
const projects = projectsCollection.map((p) => ({
  title: p.data.title,
  description: p.data.description || "",
  tech: p.data.tags || [],
  cover: p.data.cover || "",
  link: `/projects/${p.slug}/` // Link to project page
}));
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Ouassil Dahimene</title>
  </head>

  <body>
    <main class="max-w-6xl mx-auto px-6 py-12 space-y-16">
      <!-- Hero -->
      <header class="text-center space-y-6 py-10">
        <h1 class="text-5xl font-extrabold">Ouassil Dahimene</h1>
        <p class="text-xl text-gray-600">
          Data Analyst â€¢ Fraud Analyst â€¢ Data Scientist â€¢ Data Engineer
        </p>
        <div class="flex justify-center">
          <ButtonWrapper />
        </div>
      </header>

      <!-- Projects -->
      <section class="py-8">
        <h2 class="text-3xl font-bold mb-6">ðŸš€ Projects</h2>
        <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
          {projects.map((p) => (
            <ProjectCard {...p} />
          ))}
        </div>
      </section>

      <!-- Skills -->
      <section class="py-8">
        <h2 class="text-3xl font-bold mb-6">ðŸ›  Skills</h2>
        <SkillGrid skills={skills} />
      </section>

      <!-- Experience -->
      <section class="py-8">
        <h2 class="text-3xl font-bold mb-6">ðŸ“ˆ Experience</h2>
        <Timeline experiences={experiences} />
      </section>

      <!-- Contact -->
      <section class="py-8">
        <h2 class="text-3xl font-bold mb-6">ðŸ“¬ Contact</h2>
        <Contact contact={contact} />
      </section>
    </main>
  </body>
</html>
