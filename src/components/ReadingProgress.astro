---
// Reading progress indicator for blog posts
---

<div
  id="reading-progress"
  class="fixed top-0 left-0 h-1 bg-gradient-to-r from-primary to-primary/60 z-50 transition-all duration-150"
  style="width: 0%"
></div>

<script>
  function updateReadingProgress() {
    const progressBar = document.getElementById('reading-progress');
    if (!progressBar) return;

    // Calculate scroll progress
    const windowHeight = window.innerHeight;
    const documentHeight = document.documentElement.scrollHeight;
    const scrollTop = window.scrollY;

    // Calculate percentage
    const scrollPercent = (scrollTop / (documentHeight - windowHeight)) * 100;

    // Clamp between 0 and 100
    const progress = Math.min(100, Math.max(0, scrollPercent));

    // Update width
    progressBar.style.width = `${progress}%`;

    // Add shadow when scrolling
    if (progress > 0) {
      progressBar.style.boxShadow = '0 0 10px rgba(var(--primary), 0.5)';
    } else {
      progressBar.style.boxShadow = 'none';
    }
  }

  // Update on scroll
  window.addEventListener('scroll', updateReadingProgress, { passive: true });

  // Update on resize
  window.addEventListener('resize', updateReadingProgress, { passive: true });

  // Initial update
  updateReadingProgress();

  // Handle view transitions
  document.addEventListener('astro:page-load', () => {
    updateReadingProgress();
  });
</script>
